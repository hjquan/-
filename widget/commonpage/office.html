<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title></title>
    <!-- <link rel="stylesheet" type="text/css" href="../css/api.css"/> -->
    <!-- <link rel="stylesheet" type="text/css" href="../css/style.css"/> -->
    <link rel="stylesheet" href="../commonUi/aui/css/aui.css">
    <style>
        .hover {
            opacity: 0.6;
        }

        html,
        body {
            height: 100%;
        }

        .header_title {
            font-size: 18px;
            font-weight: 500;
            color: rgba(51, 51, 51, 1);
        }

        .flex_start {
            justify-content: flex-start !important;
        }
    </style>
</head>

<body>
    <div class="container">
        <header class="aui-bar aui-bar-nav aui-bar-light" id="header">
            <a class="aui-pull-left aui-btn" onclick="closeWin()" tapmode>
                <span class="aui-iconfont aui-icon-left"></span>
            </a>
            <div class="aui-title header_title aui-ellipsis-1" id="header_title">文件预览</div>
            <!-- <a class="aui-pull-right aui-btn">
                <span class="aui-iconfont aui-icon-plus"></span>
            </a> -->
        </header>

        <script src="../script/api.js"></script>

        <script>
            apiready = function() {
                //侵入式导航栏
                $api.fixStatusBar($api.dom('header'));
                var offset = $api.offset($api.byId('header'));
                var office = api.require('officePreview');
                var data = api.pageParam.office;
                console.log($api.jsonToStr(data));

                $api.text($api.byId('header_title'), data.name);
                office.open({
                    rect: {
                        x: '0',
                        y: offset.h,
                        w: 'auto',
                        h: 'auto'
                    },
                    url: data.url,
                    // fixedOn: api.frameName,
                    // fixed: true,
                    fileType: data.fileType

                });
            }

            function closeWin() {
                api.closeWin();
            }
        </script>
</body>

</html>
